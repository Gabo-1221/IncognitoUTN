 
                    <!-- Toggle Between Modals -->

                          <!-- Modal 1-->
                          <div
                          class="modal fade" 
                          id="modalToggleEditar" 
                          aria-labelledby="modalToggleLabel" 
                          tabindex="-1" style="display: none" 
                          aria-hidden="true"
                        >
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                              <div class="modal-header">
                                <h5 class="modal-title" id="modalToggleLabel">Modal 1</h5>
                                <button
                                  type="button"
                                  class="btn-close"
                                  data-bs-dismiss="modal"
                                  aria-label="Close"
                                ></button>
                              </div>
                                <div class="modal-body">                              
                                    <form >
                                      <input type="hidden" id="id" name="id">
                                    <div class="mb-3">
                                      <label class="form-label" for="nombre">Nombre de la Encuesta</label>
                                      <input type="text" class="form-control" id="nombre" name="nombre"/>
                                    </div>
                                    <div class="mb-3">
                                      <label for="areaSelect" class="form-label">Categoria</label>
                                      <select class="form-select" id="areaSelect" name="area">
                                        <option >Selecionar una Area...</option>
                                        <% areas.forEach(area => { %>
                                          <option value="<%= area._id %>"><%= area.nombre %></option>
                                      <% }) %>
                                      </select>
                                    </div>
                                    <div class="mb-3">
                                      <label class="form-label" for="user">Creado por..</label>
                                      <div class="input-group input-group-merge">
                                        <input
                                          type="text"
                                          id="user"
                                          name="user"
                                          class="form-control"
                                          placeholder="usuario"
                                          value="user1"
                                          readonly
                                        />
                                      </div>
                                    </div>
                                    <div class="mb-3">
                                      <label class="form-label" for="canperson">Cantidad de personas que podran responder</label>
                                      <input
                                        type="number"
                                        id="canperson"
                                        name="canperson"
                                        class="form-control phone-mask"
                                        placeholder="10"

                                      />
                                    </div>
                                    <div class="mb-3">
                                      <label class="form-label" for="fechat">Fecha de termino</label>
                                      <input class="form-control" type="date" name="fechat" id="fechat">
                                    </div>
                                    
                                    <div class="modal-footer">
                                    <button type="button" class="btn btn-primary" id="abrirModal2">Siguiente</button> 
                                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                                      Cancelar
                                    </button>
                                  </div>
                                </form>
                                </div>

                              </div>
                            </div>
                          </div>

                          <%- include('../forms/formEditarEncuestaP2.ejs') %>

                          <script>
                            // Event listener para abrir el Modal 2
                            document.getElementById('abrirModal2').addEventListener('click', function() {
                              // Cerrar el Modal 1
                              const modal1 = bootstrap.Modal.getInstance(document.getElementById('modalToggleEditar'));
                              modal1.hide(); 
                          
                              // Abrir el Modal 2
                              const modal2 = new bootstrap.Modal(document.getElementById('modalTogglEditar2')); 
                              modal2.show(); 
                            });
                          </script>
                               <script>
                                document.getElementById('categoriaSelects').addEventListener('change', async function() {
                                const categoriaId = this.value;
                                const encuestaId = '66ce2a15204b900b416d0b84'
                                const response = await fetch(`/admin/listaEncuestas/${encuestaId}`); // Ajustar la ruta 
                                const {encuesta, categorias, preguntas, encpre}= await response.json();
                                
                                //Separa todo de pregunta para colar en un arreglo
                                const preguntasCat = preguntas.map(pregunta => {
                                return{
                                  id: pregunta._id,
                                  id_categoria: pregunta.id_categoria,
                                  nombre: pregunta.nombre
                                }
                                });
                                
                                //filtro y separo todas la pregunta con su categoria correspondiente
                                const preguntasFiltradas = preguntasCat.filter(pregunta => 
                                  pregunta.id_categoria === categoriaId
                                ); 
                                
                                const encpreFilter = encpre.filter(encpreu =>
                                  encpreu.id_encuesta === encuesta._id
                                )

                                /* console.log('Catgegorias con preguna seleccionadas')
                                console.log(preguntasFiltradas); */
                                const preguntaList = document.getElementById('preguntaList2');
                                preguntaList.innerHTML = '';
                                
                                //mostrar la pregunta con su categori desde un checkbox
                                preguntasFiltradas.forEach(pregunta => {
                                  // ... (configuración del checkbox) ...
        
                                  // Verificar si la pregunta ya está seleccionada (usando IDs de categoría y pregunta
                                  const estaSeleccionada = encpreFilter.some(preguntaEncuesta => 
                                    preguntaEncuesta.id_encuesta === encuesta._id && preguntaEncuesta.id_pregunta === pregunta.id
                                  );
                                  
                                  
                                  // Crear el checkbox
                                  const checkbox = document.createElement('input');
                                  checkbox.type = 'checkbox';
                                  checkbox.id = `pregunta-${pregunta.id}`;
                                  checkbox.name = 'preguntas[]'; // Usar [] para enviar un array de IDs al servidor
                                  checkbox.value = pregunta.id;


                                  encpreFilter.forEach(element => {  
                                    if(element.id_pregunta === pregunta.id){
                                      checkbox.checked = true;
                                    }

                                  });
        
                              
                                  // Crear el label
                                  const label = document.createElement('label');
                                  label.htmlFor = `pregunta-${pregunta.id}`;
                                  label.textContent = pregunta.nombre;
                                  label.classList.add('form-check-label'); // Agregar clase para estilos (opcional)
            
                                  // Crear un div contenedor (opcional, para mejorar el diseño)
                                  const div = document.createElement('div');
                                  div.classList.add('form-check'); // Agregar clase para estilos (opcional)
            
                              // Agregar el checkbox y el label al div contenedor
                                  div.appendChild(checkbox);
                                  div.appendChild(label);
            
                                  // Agregar el div contenedor al preguntaList
                                  preguntaList.appendChild(div); 
                                    
                                });
                              
                                })
                              </script>